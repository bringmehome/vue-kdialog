"use strict";var _typeof2="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof="function"==typeof Symbol&&"symbol"==_typeof2(Symbol.iterator)?function(t){return void 0===t?"undefined":_typeof2(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":void 0===t?"undefined":_typeof2(t)};!function(t,o){"object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=o(require("vue")):"function"==typeof define&&define.amd?define("keydialog",["vue"],o):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?exports.keydialog=o(require("vue")):t.keydialog=o(t.Vue)}("undefined"!=typeof self?self:void 0,function(t){return function(t){function o(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,o),i.l=!0,i.exports}var e={};return o.m=t,o.c=e,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},o.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,o){return Object.prototype.hasOwnProperty.call(t,o)},o.p="",o(o.s="OONH")}({OONH:function(t,o,e){Object.defineProperty(o,"__esModule",{value:!0});var n=e("lRwf"),i=e.n(n),l={name:"kdialog",data:function(){return{body:{el:"",sTime:"",mTime:"",startX:"",startY:"",moveY:"",clientY:"",scrollTop:"",scrollWrap:null,bounceForce:100},isMobile:!1,frameLock:!1,show:!0,showlock:!0,stopBodyScroll:!0,customClass:"",rollfrom:"",_runtime:"",_type:"",width:"",title:"",content:"",ok:null,cancel:null,createdCall:null,mountedCall:null,component:"",okEvent:"",cancelEvent:"",disabled:!1,submiting:!1,shadowClose:!0,modal_enter:"",modal_leave:"",okText:"",confirmText:"",cancelText:"",timer:2500,msg:""}},created:function(){var t=this;t.isMobile="ontouchstart"in document,t.modal_enter=t.modal_leave="",t.rollfrom="from"+(t.rollfrom||"center"),t.createdCall&&t.createdCall(t)},mounted:function(){var t=this,o=document,e=t._language,n=t.okText,i=t.confirmText,l=t.cancelText;"[object String]"===Object.prototype.toString.call(e.default)?(t.okText=n||e[e.default].ok,t.confirmText=i||e[e.default].confirm,t.cancelText=l||e[e.default].cancel):(t.okText=n||e.default.ok,t.confirmText=i||e.default.confirm,t.cancelText=l||e.default.cancel),this.$nextTick(function(){var e=t.$refs[t.id].getElementsByClassName("kdialog_scroll_wrap")[0];if(t.stopBodyScroll&&e&&t.touchScroll(e),t.body.el=o.documentElement,t.stopBodyScroll&&!t.body.el.scrollbar){var n=window;"runon_pc"===t._runtime&&(t.body.el.originMarginRight=t.body.el.style.marginRight,t.body.el.scrollbarWidth=n.innerWidth-o.body.clientWidth,t.body.el.style.marginRight=t.body.el.originMarginRight+t.body.el.scrollbarWidth+"px",t.body.el.style.overflow="hidden"),t.body.el.scrollbar=!0}setTimeout(function(){t.modal_enter="modal_enter"},66),"toast"===t._type?(t.timer<500&&(t.timer=500),setTimeout(function(){t.modal_enter="",t.modal_leave="modal_leave",t.showlock=!1},t.timer-200),setTimeout(function(){if(t.ok)return t.ok(t);var e=o.querySelectorAll(".kdialog").length;return t.bodyScroll(e),t.show=!1,!1},t.timer)):setTimeout(function(){t.showlock=!1},400),t.mountedCall&&t.mountedCall(t)})},methods:{touchStart:function(t){this.sTime=+new Date,this.startX=t.touches[0].pageX,this.startY=t.touches[0].clientY},touchEnd:function(t,o){var e=this,n=t.changedTouches[0],i=n.pageX,l=n.clientY;+new Date-e.sTime<=150&&i-e.startX<=5&&l-e.startY<=5&&(1===o?e.confirmPop():2===o?e.shadowHide():e.closePop())},touchScroll:function(t){var o=this,e=null;if(void 0===o.body.scrollWrap)return!1;if(e=o.$refs.kdialog_scroll_wrap||t,o.body.scrollWrap=e,e){e.style.overflow="hidden",o.body.scrollTop=e.scrollTop,o.body.clientY=0;var n=0,i=null,l=null;i=function(){n*=.75,Math.abs(n)>=1?(l=setTimeout(i,20),o.body.scrollTop+=n,o.body.scrollWrap.scrollTo(0,o.body.scrollTop)):clearTimeout(l)},e.addEventListener("touchstart",function(t){clearTimeout(l),o.body.scrollTop=this.scrollTop,o.body.clientY=t.touches[0].clientY},!1),e.addEventListener("touchmove",function(t){o.body.moveY=t.touches[0].clientY;var e=o.body.moveY-o.body.clientY;o.body.mTime=+new Date,clearTimeout(l),o.body.scrollWrap.scrollTo(0,o.body.scrollTop-e)}),e.addEventListener("touchend",function(t){if(clearTimeout(l),0===this.scrollTop||this.scrollTop===o.body.scrollTop)return t.stopPropagation(),!1;var e=+new Date,r=e-o.body.mTime;return n=.5*(this.scrollTop-o.body.scrollTop),r<=20&&Math.abs(n)>=5&&(l=setTimeout(i,20)),!1},!1)}return!1},shadowHide:function(t){var o=this;o.shadowClose&&!o.showlock&&(o.isMobile&&"click"!==t||!o.isMobile&&"click"===t)&&o.close()},confirmPop:function(t){var o=this;o.submiting||o.disabled||(o.isMobile&&"click"!==t||!o.isMobile&&"click"===t)&&(o.submiting=!0,o.ok?o.ok(o):o.$bus&&o.okEvent?o.$bus.$emit(o.okEvent,{$dialog:o}):o.close())},closePop:function(t){var o=this;return!!(o.isMobile&&"click"!==t||!o.isMobile&&"click"===t)&&(o.cancel?o.cancel(o):o.$bus&&o.cancelEvent?o.$bus.$emit(o.cancelEvent,{$dialog:o}):(o.close(),!1))},close:function(){var t=this;t.modal_enter="",t.modal_leave="modal_leave",setTimeout(function(){var o=document.querySelectorAll(".kdialog").length;t.show=!1,setTimeout(function(){t.bodyScroll(o),t.$destroy()})},200)},bodyScroll:function(t){var o=this;o.stopBodyScroll&&t<=1&&setTimeout(function(){"runon_pc"===o._runtime&&(o.body.el.style.overflow="",o.body.el.style.marginRight=o.body.el.originMarginRight),o.body.el.scrollbar=!1})}}},r=function(){var t=this,o=t.$createElement,e=t._self._c||o;return t.show?e("div",{ref:t.id,staticClass:"kdialog",class:["loading"===this._type?"loading":"modal_"+t._type,t._runtime,t.customClass,t.modal_enter,t.modal_leave,t.rollfrom],attrs:{id:t.id},on:{touchstart:function(o){o.stopPropagation(),t.touchStart(o)},touchmove:function(t){t.stopPropagation(),t.preventDefault()},click:function(o){o.stopPropagation(),o.preventDefault(),t.shadowHide("click")}}},["loading"==t._type?e("i",{staticClass:"icon-loading"}):e("div",{staticClass:"kdialog_bg",on:{click:function(o){o.stopPropagation(),o.preventDefault(),t.shadowHide("click")},touchend:function(o){o.stopPropagation(),o.preventDefault(),t.touchEnd(o,2)}}}),"loading"!=t._type?e("div",{staticClass:"kdialog_wrap",style:t.width?"width:"+t.width+";min-width:auto;":"",on:{click:function(t){t.stopPropagation(),t.preventDefault()}}},["toast"===t._type?e("div",{staticClass:"kdialog_msg",domProps:{innerHTML:t._s(t.msg)}}):e("div",{staticClass:"kdialog_box"},[t.title?e("div",{staticClass:"kdialog_header"},[e("div",{staticClass:"kdialog_title",domProps:{innerHTML:t._s(t.title)}})]):t._e(),e("i",{staticClass:"kdialog_close",on:{click:function(o){o.stopPropagation(),o.preventDefault(),t.closePop("click")},touchstart:function(o){o.stopPropagation(),t.touchStart(o)},touchend:function(o){return o.stopPropagation(),o.preventDefault(),t.touchEnd(o)}}}),t.component?e("div",{staticClass:"kdialog_content"},[e(t.component,{tag:"component"})],1):e("div",{staticClass:"kdialog_content",domProps:{innerHTML:t._s(t.content)}}),e("div",{staticClass:"kdialog_footer",class:t._type+"_footer"},[e("a",{staticClass:"confirm",class:t.disabled?"disabled":t.submiting?"submiting":"",attrs:{href:"javascript:;"},on:{click:function(o){o.stopPropagation(),o.preventDefault(),t.confirmPop("click")},touchstart:function(o){return o.stopPropagation(),t.touchStart(o)},touchend:function(o){o.stopPropagation(),o.preventDefault(),t.touchEnd(o,1)}}},[t._v(t._s("confirm"===t._type?t.confirmText:t.okText))]),"confirm"===t._type?e("a",{staticClass:"cancel",attrs:{href:"javascript:;"},on:{click:function(o){o.stopPropagation(),o.preventDefault(),t.closePop("click")},touchstart:function(o){return o.stopPropagation(),t.touchStart(o)},touchend:function(o){return o.stopPropagation(),o.preventDefault(),t.touchEnd(o)}}},[t._v(t._s(t.cancelText))]):t._e()])])]):t._e()]):t._e()},a=[],c={render:r,staticRenderFns:a},s=c,u=e("Z0/y"),d=u(l,s,!1,null,null,null),f=d.exports,p=i.a.extend(f),m={runtime:"pc",language:{default:"zh-cn","zh-cn":{ok:"确定",confirm:"确定",cancel:"取消"},en:{ok:"OK",confirm:"Confirm",cancel:"Cancel"}},keyDialogId:171200,init:function(t,o){m.keyDialogId+=1;var e=new p({data:t}),n="kDialog_"+m.keyDialogId;return e.id=n,e._type=o,e._language=m.language,e._runtime="runon_"+m.runtime,e.vm=e.$mount(),e.dom=e.vm.$el,document.body.appendChild(e.dom),e.dom.style.zIndex=m.keyDialogId,e.vm},confirm:function(t){return m.init(t,"confirm")},alert:function(t){return m.init(t,"alert")},toast:function(t){return m.init(t,"toast")},loading:function(t){return m.init(t,"loading")}};o.default={install:function(){i.a.prototype.$toast=m.toast,i.a.prototype.$alert=m.alert,i.a.prototype.$loading=m.loading,i.a.prototype.$confirm=m.confirm},setRunTime:function(t){m.runtime=t},setLanguage:function(t){m.language.default=t},eventbus:function(){var t=new i.a;Object.defineProperties(i.a.prototype,{$bus:{get:function(){return t}}})}}},"Z0/y":function(t,o){t.exports=function(t,o,e,n,i,l){var r,a=t=t||{},c=_typeof(t.default);"object"!==c&&"function"!==c||(r=t,a=t.default);var s="function"==typeof a?a.options:a;o&&(s.render=o.render,s.staticRenderFns=o.staticRenderFns,s._compiled=!0),e&&(s.functional=!0),i&&(s._scopeId=i);var u;if(l?(u=function(t){t=t||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,t||"undefined"==typeof __VUE_SSR_CONTEXT__||(t=__VUE_SSR_CONTEXT__),n&&n.call(this,t),t&&t._registeredComponents&&t._registeredComponents.add(l)},s._ssrRegister=u):n&&(u=n),u){var d=s.functional,f=d?s.render:s.beforeCreate;d?(s._injectStyles=u,s.render=function(t,o){return u.call(o),f(t,o)}):s.beforeCreate=f?[].concat(f,u):[u]}return{esModule:r,exports:a,options:s}}},lRwf:function(o,e){o.exports=t}})});